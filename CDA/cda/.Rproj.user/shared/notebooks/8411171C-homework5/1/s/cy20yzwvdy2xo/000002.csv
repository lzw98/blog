"0","library(ResourceSelection)"
"0","library(cdabookfunc)"
"0","library(tidyverse)"
"0","library(cdabookdb)"
"0","data('smoking_lungcancer_cn')"
"0","slc <- data.frame(smoking_lungcancer_cn)"
"0","slc <- spread(slc,LungCancer,Freq)"
"0","m <- glm(cbind(Yes,No)~factor(Smoking)+factor(City),data = slc, family = binomial(link = 'logit'));summary(m)"
"1","
Call:
"
"1",""
"1","glm(formula = cbind(Yes, No) ~ factor(Smoking) + factor(City), 
    family = binomial(link = ""logit""), data = slc)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","     Min  "
"1","      1Q  "
"1","  Median  "
"1","      3Q  "
"1","     Max  "
"1","
"
"1","-1.21781  "
"1","-0.14842  "
"1","-0.00012  "
"1"," 0.16817  "
"1"," 1.35470  "
"1","
"
"1","
Coefficients:
"
"1","                     "
"1","  Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)          "
"1","  0.228380"
"1","   0.113976"
"1","   2.004"
"1","   0.0451"
"1"," *  "
"1","
factor(Smoking)No    "
"1"," -0.777062"
"1","   0.046775"
"1"," -16.613"
"1","  < 2e-16"
"1"," ***"
"1","
factor(City)Shanghai "
"1","  0.055618"
"1","   0.119570"
"1","   0.465"
"1","   0.6418"
"1","    "
"1","
factor(City)Shenyang "
"1"," -0.027739"
"1","   0.120071"
"1","  -0.231"
"1","   0.8173"
"1","    "
"1","
factor(City)Nanjing  "
"1","  0.005764"
"1","   0.140911"
"1","   0.041"
"1","   0.9674"
"1","    "
"1","
factor(City)Harbin   "
"1","  0.018187"
"1","   0.129473"
"1","   0.140"
"1","   0.8883"
"1","    "
"1","
factor(City)Zhengzhou"
"1","  0.028782"
"1","   0.144755"
"1","   0.199"
"1","   0.8424"
"1","    "
"1","
factor(City)Taiyuan  "
"1"," -0.745683"
"1","   0.185519"
"1","  -4.019"
"1"," 5.83e-05"
"1"," ***"
"1","
factor(City)Nanchang "
"1"," -0.054906"
"1","   0.170996"
"1","  -0.321"
"1","   0.7481"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 310.8951  on 15  degrees of freedom
"
"1",""
"1","Residual deviance:   5.1958  on  7  degrees of freedom
"
"1","AIC: "
"1",""
"1","121.05"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","3"
"1",""
"1","
"
"1","
"
"0","# X2 test"
"0","df <- nrow(slc) - length(coef(m))"
"0","X2 <- sum(resid(m, type = ""pearson"") ^ 2);X2"
"1","[1]"
"1"," 5.199866"
"1","
"
"0","x2_pvalue <- 1- pchisq(X2, df)"
"0","c(X2 = X2, pvalue = x2_pvalue)"
"1","       X2 "
"1","   pvalue "
"1","
"
"1","5.1998657 "
"1","0.6355872 "
"1","
"
"0","# Check residuals to analyze further the quality of fit"
"0","res <- resid(m, type = ""pearson"")"
"0","res[order(res)]"
"1","            8 "
"1","           11 "
"1","           10 "
"1","           14 "
"1","            3 "
"1","
"
"1","-1.2067620236 "
"1","-0.9445258372 "
"1","-0.3902934956 "
"1","-0.2040742691 "
"1","-0.1294368396 "
"1","
"
"1","           15 "
"1","            2 "
"1","            6 "
"1","            5 "
"1","            1 "
"1","
"
"1","-0.1227104248 "
"1","-0.0322738531 "
"1","-0.0008511773 "
"1"," 0.0006159253 "
"1"," 0.0203993045 "
"1","
"
"1","           13 "
"1","            4 "
"1","           16 "
"1","            9 "
"1","            7 "
"1","
"
"1"," 0.1010236316 "
"1"," 0.1460958592 "
"1"," 0.2352749248 "
"1"," 0.2612895164 "
"1"," 0.7769830112 "
"1","
"
"1","           12 "
"1","
"
"1"," 1.3657735102 "
"1","
"
