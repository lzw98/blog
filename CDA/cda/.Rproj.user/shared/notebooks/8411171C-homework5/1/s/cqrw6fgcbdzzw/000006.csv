"0","library(ResourceSelection)"
"2","ResourceSelection 0.3-5 	 2019-07-22
"
"0","data(""horseshoecrabs"")"
"0","horseshoecrabs$psat <- as.integer(horseshoecrabs$Satellites > 0)"
"0","m <- glm(psat~Weight,data = horseshoecrabs,family = binomial(link = 'logit'));summary(m)"
"1","
Call:
"
"1",""
"1","glm(formula = psat ~ Weight, family = binomial(link = ""logit""), 
    data = horseshoecrabs)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","    Min  "
"1","     1Q  "
"1"," Median  "
"1","     3Q  "
"1","    Max  "
"1","
"
"1","-2.1108  "
"1","-1.0749  "
"1"," 0.5426  "
"1"," 0.9122  "
"1"," 1.6285  "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)"
"1","  -3.6947"
"1","     0.8802"
"1","  -4.198"
"1"," 2.70e-05"
"1"," ***"
"1","
Weight     "
"1","   1.8151"
"1","     0.3767"
"1","   4.819"
"1"," 1.45e-06"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 225.76  on 172  degrees of freedom
"
"1",""
"1","Residual deviance: 195.74  on 171  degrees of freedom
"
"1","AIC: "
"1",""
"1","199.74"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","4"
"1",""
"1","
"
"1","
"
"0","pi0 <- 0.642 # cut-off value"
"0","pred_prob <- predict(m, type = ""response"")"
"0","pred_type <- cut("
"0","pred_prob, breaks = c(0, pi0, 1), labels = 0:1,"
"0","include.lowest = TRUE"
"0",")"
"0","classification_table <- table(horseshoecrabs$psat, pred_type)"
"0","addmargins(classification_table)"
"1","     pred_type
"
"1","     "
"1","   0"
"1","   1"
"1"," Sum"
"1","
  0  "
"1","  45"
"1","  17"
"1","  62"
"1","
  1  "
"1","  43"
"1","  68"
"1"," 111"
"1","
  Sum"
"1","  88"
"1","  85"
"1"," 173"
"1","
"
"0","sensitivity <- 45/62;sensitivity"
"1","[1]"
"1"," 0.7258065"
"1","
"
"0","specificity <- 85/173;specificity"
"1","[1]"
"1"," 0.4913295"
"1","
"
"0","#Roc curve and AUC area"
"0","library(ROCR)"
"0","par(pty = ""s"")"
"0","pred <- prediction(fitted(m), horseshoecrabs$psat)"
"0","perf <- performance(pred, ""tpr"", ""fpr"")"
"0","plot(perf, asp =1, xaxs=""i"", yaxs=""i"")"
