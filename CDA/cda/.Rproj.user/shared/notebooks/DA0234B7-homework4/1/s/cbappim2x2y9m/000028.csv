"0","library(cdabookdb)"
"0","library(tidyverse)"
"0","library(cdabookfunc)"
"0","data('merit_pay_race');"
"0",""
"0","cmh.test(cond = 'District',merit_pay_race)"
"1","
"
"1","	Mantel-Haenszel chi-squared test without continuity correction"
"1","
"
"1","
"
"1","data:  "
"1",""
"1","treat"
"1",""
"1","
"
"1","Mantel-Haenszel X-squared = 7.8149, df = 1, p-value = 0.005182"
"1","
"
"1","alternative hypothesis: "
"1","true "
"1",""
"1","common odds ratio"
"1",""
"1"," is "
"1",""
"1","not equal to"
"1",""
"1"," "
"1",""
"1","1"
"1",""
"1","
"
"1","95"
"1",""
"1"," percent confidence interval:
"
"1",""
"1"," "
"1",""
"1","0.2652676 0.8036854"
"1",""
"1","
"
"1","sample estimates:
"
"1","common odds ratio "
"1","
"
"1","        0.4617269 "
"1","
"
"1","
"
"0","#Show how you could alternatively test the hypothesis in (a) using a test about a parameter in a logistic regression model."
"0","data <- data.frame(merit_pay_race)"
"0","data <- spread(data,MeritPay,Freq)"
"0","data$pro <- data$Yes/(data$Yes+data$No)"
"0","m <- glm(pro~factor(Race)+factor(District),family = binomial(link = 'logit'),data = data);summary(m)"
"1","
Call:
"
"1",""
"1","glm(formula = pro ~ factor(Race) + factor(District), family = binomial(link = ""logit""), 
    data = data)"
"1",""
"1","

"
"1","Deviance Residuals: 
"
"1","        1  "
"1","        2  "
"1","        3  "
"1","        4  "
"1","        5  "
"1","        6  "
"1","        7  "
"1","        8  "
"1","
"
"1"," 0.097165  "
"1","-0.117939  "
"1"," 0.062987  "
"1","-0.080314  "
"1","-0.129636  "
"1"," 0.166337  "
"1"," 0.007295  "
"1","-0.009318  "
"1","
"
"1","        9  "
"1","       10  "
"1","
"
"1","-0.024378  "
"1"," 0.030597  "
"1","
"
"1","
Coefficients:
"
"1","                  "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","
(Intercept)       "
"1","   0.7660"
"1","     1.7899"
"1","   0.428"
"1","    0.669"
"1","
factor(Race)White "
"1","   0.9013"
"1","     1.5477"
"1","   0.582"
"1","    0.560"
"1","
factor(District)NE"
"1","   0.2904"
"1","     2.4882"
"1","   0.117"
"1","    0.907"
"1","
factor(District)NW"
"1","  -0.2804"
"1","     2.3202"
"1","  -0.121"
"1","    0.904"
"1","
factor(District)SE"
"1","   0.0448"
"1","     2.4031"
"1","   0.019"
"1","    0.985"
"1","
factor(District)SW"
"1","  -0.1556"
"1","     2.3483"
"1","  -0.066"
"1","    0.947"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 0.497478  on 9  degrees of freedom
"
"1",""
"1","Residual deviance: 0.079913  on 4  degrees of freedom
"
"1","AIC: "
"1",""
"1","17.709"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","4"
"1",""
"1","
"
"1","
"
